[{"path":"https://buenrostrolab.github.io/FigR-docs/articles/FigR_shareseq.html","id":"running-figr-on-multi-modal-data-e-g--share-seq-10x-multi-ome","dir":"Articles","previous_headings":"","what":"Running FigR on multi-modal data (e.g. SHARE-seq / 10x multi-ome)","title":"Application of FigR to SHARE-seq skin data","text":"demo application FigR workflow 1 previously published SHARE-seq data 2","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/articles/FigR_shareseq.html","id":"data-downloads-pre-processing","dir":"Articles","previous_headings":"Running FigR on multi-modal data (e.g. SHARE-seq / 10x multi-ome)","what":"Data downloads / Pre-processing","title":"Application of FigR to SHARE-seq skin data","text":"data used tutorial can downloaded (WARNING: Downloading data take ~ 0.5 GB hard drive space) shown . set unzipped directory (destination folder) working directory, prior loading R objects. first step FigR determine peak-gene associations using paired single cell accessibility (scATAC-seq) RNA (scRNA-seq) count data First, let us load dependencies, including main FigR package require scATAC-seq peak counts SummarizedExperiment object, rowRanges fixed-width accessibility peak ranges (typically 300 bp ), assay object sparseMatrix Tn5-instertion counts per peak per cell. Additionally, scRNA-seq matrix can provided sparseMatrix log-normalized gene expression levels cells (e.g. processed using Seurat) example, show two inputs pertaining SHARE-seq experiment performed mouse skin cells. simplicity, run subset cells (quality filtered, sampled n=10,000 cells faster run-time). result, note results similar presented Kartha et al. , identical. Additionally, load matrix object cisTopic probability scores generated part dimensionality reduction process implemented scATAC-seq count data using cisTopic R package. enable us derive cell kNN matrix (k-nearest neighbors graph) used smoothing data. Note, used alternative method dimensionality reduction, can derive cell kNN matrix using alternative inputs (e.g. using top N LSI / PCA components) can use previously computed UMAP embeddings cell type annotations take look data encompasses.  Now, ready run peak-gene correlations across cells (see )","code":"# Directory where data will be downloaded to workingDir <- \"/Users/vinay/Documents/FigR_package/shareseq\" shareseqZip <- \"https://s3.us-east-1.amazonaws.com/vkartha/FigR/FigR_SHAREseq.zip\" download.file(url = shareseqZip,               destfile = paste0(workingDir,basename(shareseqZip))) unzip(paste(workingDir,basename(shareseqZip),sep=\"/\"),exdir = workingDir,overwrite = FALSE)  setwd(workingDir) library(dplyr) library(FNN) #> Warning: package 'FNN' was built under R version 4.0.4 library(chromVAR) library(doParallel) library(BuenColors) library(FigR) #> Warning: package 'cowplot' was built under R version 4.0.4 library(BSgenome.Mmusculus.UCSC.mm10) ATAC.se <- readRDS(\"./shareseq_skin_SE_final.rds\") RNAmat <- readRDS(\"./shareseq_skin_RNAnorm_final.rds\") # Normalized  dim(ATAC.se) # Peaks x Cells #> [1] 344592  34774 dim(RNAmat) # Genes x Cells #> [1] 19303 34774 set.seed(123) cellsToKeep <- sample(colnames(ATAC.se),size = 10000,replace = FALSE)  ATAC.se <- ATAC.se[,cellsToKeep] RNAmat <- RNAmat[,cellsToKeep]  # Remove genes with zero expression across all cells RNAmat <- RNAmat[Matrix::rowSums(RNAmat)!=0,] cisAssign <- readRDS(\"./shareseq_skin_cisTopicPs.rds\") dim(cisAssign) # Cells x Topics  all(cellsToKeep %in% rownames(cisAssign))  # Subset cisAssign <- cisAssign[cellsToKeep,] # Derive cell kNN using this set.seed(123) cellkNN <- get.knn(cisAssign,k = 30)$nn.index dim(cellkNN) rownames(cellkNN) <- cellsToKeep annoCols <- readRDS(\"./shareseq_skin_annoCols.rds\")  # Plot library(ggplot2) colData(ATAC.se) %>% as.data.frame() %>% ggplot(aes(UMAP1,UMAP2,color=cellAnnot)) +    geom_point(size=0.5) + scale_color_manual(values=annoCols)+   theme_classic() + guides(colour = guide_legend(override.aes = list(size=2)))"},{"path":"https://buenrostrolab.github.io/FigR-docs/articles/FigR_shareseq.html","id":"peak-gene-association-testing","dir":"Articles","previous_headings":"Running FigR on multi-modal data (e.g. SHARE-seq / 10x multi-ome)","what":"Peak-gene association testing","title":"Application of FigR to SHARE-seq skin data","text":"Next, take default (10 kb) window around gene’s TSS, compute Spearman correlation across cells peak accessibility counts (mean-centered) normalized RNA expression. peak-gene pair correlation, use (default n=100) background peaks matched GC content accessibility correlate gene, can test significance (permutation p-value). works lot faster supported parallelization (due intensive background correlation calculations). , use 4 cores. 10k cells, 478,254 resulting gene-peak pairs 100 background calculations per pair, takes ~ 11.8 hrs (warned!). recommend running next chunk separately using Rscript (outside Rstudio) saving resulting table, can loaded next steps","code":"# Don't run interactively cisCorr <- FigR::runGenePeakcorr(ATAC.se = ATAC.se,                            RNAmat = RNAmat,                            genome = \"mm10\", # One of hg19, mm10 or hg38                             nCores = 4,                            p.cut = NULL, # Set this to NULL and we can filter later                            n_bg = 100) head(cisCorr)"},{"path":"https://buenrostrolab.github.io/FigR-docs/articles/FigR_shareseq.html","id":"determining-dorcs","dir":"Articles","previous_headings":"Running FigR on multi-modal data (e.g. SHARE-seq / 10x multi-ome)","what":"Determining DORCs","title":"Application of FigR to SHARE-seq skin data","text":"can now filter correlations based background p-value, summarize genes relatively high number significant peak-gene associations (.e. Domains regulatory chromatin ‘DORCs’)  can also just get full ranked table genes number significantly associated peaks, instead getting gene names (can threshold )","code":"cisCorr.filt <- cisCorr %>% filter(pvalZ <= 0.05)  dorcGenes <- dorcJPlot(dorcTab = cisCorr.filt,                          cutoff = 10, # No. sig peaks needed to be called a DORC                          labelTop = 20,                          returnGeneList = TRUE, # Set this to FALSE for just the plot                          force=2) # Unfiltered numDorcs <- cisCorr.filt %>% group_by(Gene) %>% tally() %>% arrange(desc(n)) numDorcs #> # A tibble: 12,765 x 2 #>    Gene       n #>    <chr>  <int> #>  1 Notch1    50 #>  2 Atf3      48 #>  3 Gfpt2     41 #>  4 Col1a2    40 #>  5 Col3a1    37 #>  6 Ifrd1     37 #>  7 Emp1      36 #>  8 Thbs1     36 #>  9 Cyr61     33 #> 10 Ezr       33 #> # ... with 12,755 more rows"},{"path":"https://buenrostrolab.github.io/FigR-docs/articles/FigR_shareseq.html","id":"visualizing-dorcs","dir":"Articles","previous_headings":"Running FigR on multi-modal data (e.g. SHARE-seq / 10x multi-ome)","what":"Visualizing DORCs","title":"Application of FigR to SHARE-seq skin data","text":"get DORC accessibility scores, simply sum chromatin accessibility peak counts peaks associated given gene. NOTE: crucial use exact SummarizedExperiment object one used runGenePeakcorr step can smooth (sparse) counts, visualize side--side expression.","code":"dorcMat <- getDORCScores(ATAC.se = ATAC.se, # Has to be same SE as used in previous step                          dorcTab = cisCorr.filt,                          geneList = dorcGenes,                          nCores = 4) #> ........ #> Normalizing scATAC counts .. #> Centering counts for cells sequentially in groups of size  5000  .. #>  #> Computing centered counts for cells:  1  to  5000 .. #> Computing centered counts per cell using mean reads in features .. #>  #> Computing centered counts for cells:  5001  to  10000 .. #> Computing centered counts per cell using mean reads in features .. #>  #> Merging results.. #> Done! #> Computing DORC scores .. #> Running in parallel using  1 cores .. #>  #> Time Elapsed:  2.06359885136286 mins dim(dorcMat) #> [1]   586 10000 # Smooth dorc scores using cell KNNs (k=30) dorcMat.s <- smoothScoresNN(NNmat = cellkNN[,1:30],mat = dorcMat,nCores = 4)  # Smooth RNA using cell KNNs # This takes longer since it's all genes RNAmat.s <- smoothScoresNN(NNmat = cellkNN[,1:30],mat = RNAmat,nCores = 4) # Visualize on pre-computed UMAP umap.d <- as.data.frame(colData(ATAC.se)[,c(\"UMAP1\",\"UMAP2\")])  # DORC score for Dlx3 dorcg <- plotMarker2D(umap.d,dorcMat.s,markers = c(\"Dlx3\"),maxCutoff = \"q0.99\",colorPalette = \"brewer_heat\") + ggtitle(\"Dlx3 DORC\") #> Plotting  Dlx3 #> Warning: package 'ggrastr' was built under R version 4.0.4 # RNA for Dlx3 rnag <- plotMarker2D(umap.d,RNAmat.s,markers = c(\"Dlx3\"),maxCutoff = \"q0.99\",colorPalette = \"brewer_purple\") + ggtitle(\"Dlx3 RNA\") #> Plotting  Dlx3 library(patchwork) #> Warning: package 'patchwork' was built under R version 4.0.4 dorcg + rnag"},{"path":"https://buenrostrolab.github.io/FigR-docs/articles/FigR_shareseq.html","id":"tf-gene-associations","dir":"Articles","previous_headings":"Running FigR on multi-modal data (e.g. SHARE-seq / 10x multi-ome)","what":"TF-gene associations","title":"Application of FigR to SHARE-seq skin data","text":"core component FigR determine TFs putative regulators (acivators repressors) DORCs. specifying built-reference motif database (see Methods associated manuscript), providing smoothed DORC accessibility RNA count matrices input, determine DORCs enriched different TF binding motifs, addition testing correlations TF RNA expression. can done using single command FigR 708 TFs 586 DORCs (testing n=50 background iterations), took ~ 1.5 hrs using 4 cores (10k cells).","code":"figR.d <- runFigRGRN(ATAC.se = ATAC.se, # Must be the same input as used in runGenePeakcorr()                      dorcTab = cisCorr.filt, # Filtered peak-gene associations                      genome = \"mm10\",                      dorcMat = dorcMat.s,                      rnaMat = RNAmat.s,                       nCores = 4)"},{"path":"https://buenrostrolab.github.io/FigR-docs/articles/FigR_shareseq.html","id":"visualizing-figr-results","dir":"Articles","previous_headings":"Running FigR on multi-modal data (e.g. SHARE-seq / 10x multi-ome)","what":"Visualizing FigR results","title":"Application of FigR to SHARE-seq skin data","text":"ways can visualize resulting TF-DORC associations inferred FigR, vary based thresholding type layout choice","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/articles/FigR_shareseq.html","id":"global-regulation-profile","dir":"Articles","previous_headings":"Running FigR on multi-modal data (e.g. SHARE-seq / 10x multi-ome) > Visualizing FigR results","what":"Global regulation profile","title":"Application of FigR to SHARE-seq skin data","text":"First, can simply plot TF-DORC associations (tested TFs tested DORCs) scatter plot, point TF-DORC pair. x-axis provides significance correlation TF’s expression DORC accessibility (Z-test relative background), y-axis shows relative enrichment TF’s motif among DORC-associated peaks. Points colored determined FigR regulation score. Putative activating associations highlighted red, repressive associations blue","code":"figR.d %>%    ggplot(aes(Corr.log10P,Enrichment.log10P,color=Score)) +    ggrastr::geom_point_rast(size=0.01,shape=16) +    theme_classic() +    scale_color_gradientn(colours = jdb_palette(\"solar_extra\"),limits=c(-3,3),oob = scales::squish,breaks=scales::breaks_pretty(n=3))"},{"path":"https://buenrostrolab.github.io/FigR-docs/articles/FigR_shareseq.html","id":"ranking-tf-drivers","dir":"Articles","previous_headings":"Running FigR on multi-modal data (e.g. SHARE-seq / 10x multi-ome) > Visualizing FigR results","what":"Ranking TF drivers","title":"Application of FigR to SHARE-seq skin data","text":"can rank TFs overall (mean) regulation score across DORCs. helps give snapshot major activators repressors across cells data given DORCs  Specify myLabels parameter label plots select TFs (just top bottom percentiles default). Useful see TFs interest fall among TFs can also rank total number targets per TF, passing specified score filter can set interactive parameter TRUE hover bars detail, cases ’s hard tell labels axes (plotting many TFs)","code":"rankDrivers(figR.d,rankBy = \"meanScore\",interactive = FALSE) #> Warning: ggrepel: 50 unlabeled data points (too many overlaps). Consider #> increasing max.overlaps rankDrivers(figR.d,score.cut = 2,rankBy = \"nTargets\",interactive = TRUE)"},{"path":"https://buenrostrolab.github.io/FigR-docs/articles/FigR_shareseq.html","id":"scatter-view","dir":"Articles","previous_headings":"Running FigR on multi-modal data (e.g. SHARE-seq / 10x multi-ome) > Visualizing FigR results","what":"Scatter view","title":"Application of FigR to SHARE-seq skin data","text":"can also subset plot restricting specific TFs. points (TFs) passing user-defined threshold labeled putative drivers queried DORC","code":"plotDrivers(figR.d,score.cut = 2,marker = \"Lef1\")"},{"path":"https://buenrostrolab.github.io/FigR-docs/articles/FigR_shareseq.html","id":"heatmap-view","dir":"Articles","previous_headings":"Running FigR on multi-modal data (e.g. SHARE-seq / 10x multi-ome) > Visualizing FigR results","what":"Heatmap view","title":"Application of FigR to SHARE-seq skin data","text":"heatmap plot, take TF-DORC association meets score cut-, plot union TFs (columns) x DORCs (rows), colored associated FigR regulation score  can also restrict heatmap correspond specific DORCs TFs changing TF DORC parameter NULL (default)","code":"library(ComplexHeatmap) plotfigRHeatmap(figR.d = figR.d,                 score.cut = 2,                 column_names_gp = gpar(fontsize=6), # from ComplexHeatmap                 show_row_dend = FALSE # from ComplexHeatmap                 ) library(ComplexHeatmap) plotfigRHeatmap(figR.d = figR.d,                 score.cut = 1,                 TFs = c(\"Lef1\",\"Dlx3\",\"Grhl1\",\"Gata6\",\"Klf3\",\"Barx2\",\"Pou2f3\"),                 column_names_gp = gpar(fontsize=6), # from ComplexHeatmap                 show_row_dend = FALSE # from ComplexHeatmap                 )"},{"path":"https://buenrostrolab.github.io/FigR-docs/articles/FigR_shareseq.html","id":"network-view","dir":"Articles","previous_headings":"Running FigR on multi-modal data (e.g. SHARE-seq / 10x multi-ome) > Visualizing FigR results","what":"Network view","title":"Application of FigR to SHARE-seq skin data","text":"Similarly, can render significant associations graph network, node TF/DORC edge association passing user-specified threshold","code":"library(networkD3) #> Warning: package 'networkD3' was built under R version 4.0.5 plotfigRNetwork(figR.d,                 score.cut = 2,                 TFs = c(\"Lef1\",\"Dlx3\",\"Grhl1\",\"Gata6\",\"Klf3\",\"Barx2\",\"Pou2f3\"),                 weight.edges = TRUE)"},{"path":"https://buenrostrolab.github.io/FigR-docs/articles/FigR_stim.html","id":"running-figr-on-independently-assayed-scatac-seq-and-scrna-seq-data","dir":"Articles","previous_headings":"","what":"Running FigR on independently assayed scATAC-seq and scRNA-seq data","title":"Analyzing independently assayed scATAC-seq and scRNA-seq data using FigR","text":"many instances, don’t true multi-modal data (.e. chromatin accessibility gene expression profiled single cell). cases, computationally determining “paired” cells across assays cellular contexts useful, necessary first step prior performing downstream analysis, including cis-regulatory correlation analyses (.e. peak--gene associations) gene regulatory network inference steps part FigR framework. demo application FigR workflow independently generated scATAC-seq scRNA-seq data using subset data generated analyzed associated manuscript 1","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/articles/FigR_stim.html","id":"data-downloads-pre-processing","dir":"Articles","previous_headings":"Running FigR on independently assayed scATAC-seq and scRNA-seq data","what":"Data downloads / Pre-processing","title":"Analyzing independently assayed scATAC-seq and scRNA-seq data using FigR","text":", use subset PBMC stimulus dataset pertaining DMSO (Control_1h) condition cells independently profiled scATAC-seq scRNA-seq data. data used tutorial can downloaded (WARNING: Downloading data take ~ 71 MB hard drive space) shown . set unzipped directory (destination folder) working directory, prior loading R objects. Please see vignette applying FigR multi-modal data details input object data structures, function parameters, run time , let us load dependencies, including main FigR package , require/load following input objects: SummarizedExperiment object peaks x cells, housing scATAC-seq reads accessibility peaks raw counts, along GRanges peaks used RowRanges info normalized sparseMatrix object genes x cells, housing scRNA-seq gene counts (e.g. exported Seurat) Previously computed canonical correlation analyis (CCA) components (determined using CCA pipeline Seurat) ATAC RNA PBMCs Latent Semantic Index (LSI) components scATAC-seq cells, used derive cell k-nearest neighbors smooth scores (NOTE: multi-modal vignette, show can use alternative cell embeddings derive kNN, cisTopic scores. Essentially, use whichever reduced dimensions used project cells 2D visualization) example, show inputs pertaining independently generated scATAC scRNA-seq data human PBMCs. simplicity, run subset cells (quality filtered, Control 1h DMSO condition cells faster run-time). result, note results similar presented Kartha et al. , identical. Since ’re going integrate two datasets (unpaired now), use shared co-embedding can generated ATAC RNA cells. See tutorial examples can done. case, used union top variable ATAC genescores (based fixed window around gene’s TSS), top variable RNA genes across cells, performed CCA using resulting features ATAC/RNA cells input RunCCA function. now alternative approaches faster / scale better co-embedding larger datasets, including RPCA framework implemented Seurat package. can now visualize UMAP ATAC-RNA cell co-embedding, coloring cells assay come (similar / shared cell states across two assays co-localize degree 2D)  Now, use co-embeddings pair cells using geodesic distance-based pairing approach. step using pairCells function, providing separate ATAC RNA cell components input highlighted : setting keepUnique parameter specified TRUE, filter cells ATAC cell barcode appears resulting pairs (case ). can now visualize resulting ATAC-RNA pairs CCA UMAP  final step, subset ATAC RNA count objects match determined ATAC-RNA paired cells, use input later steps","code":"# Directory where data will be downloaded to workingDir <- \"/Users/vinay/Documents/FigR_package/biorad\" stimZip <- \"https://s3.us-east-1.amazonaws.com/vkartha/FigR/FigR_stim.zip\" download.file(url = stimZip,               destfile = paste(workingDir,basename(stimZip),sep = \"/\")) unzip(zipfile = paste(workingDir,basename(stimZip),sep = \"/\"),exdir = workingDir,overwrite = FALSE)  setwd(workingDir) library(doParallel) library(BuenColors) library(FigR) #> Warning: package 'cowplot' was built under R version 4.0.4 library(BSgenome.Hsapiens.UCSC.hg19) ATAC.se <- readRDS(\"./control1h_PBMC_atac_SE.rds\") RNAmat <- readRDS(\"./control1h_PBMC_RNAnorm.rds\")   dim(ATAC.se) # Peaks x ATAC cells #> [1] 219136   5352 dim(RNAmat) # Genes x RNA cells #> [1] 15584  3508 # Load CCA components (used for pairing) # This was derived by running CCA (using all cells) between the original ATAC/RNA data using the top variable scATAC-seq gene scores and scRNA-seq gene expression CCA_PCs <- readRDS('./control1h_PBMC_atac_rna_CCA_l2.rds') dim(CCA_PCs) # ATAC + RNA (rows), n components (columns) #> [1] 8860   50 # This is just to differentiate ATAC/RNA from the combined matrix of CCA components so they can be separated for pairing # Based on barcode naming conventions to differentiate ATAC/RNA in our  head(rownames(CCA_PCs)) # ATAC cells #> [1] \"Control_1h_Donor1_S1_BC0004_N01\" \"Control_1h_Donor1_S1_BC0006_N01\" #> [3] \"Control_1h_Donor1_S1_BC0008_N01\" \"Control_1h_Donor1_S1_BC0009_N01\" #> [5] \"Control_1h_Donor1_S1_BC0010_N01\" \"Control_1h_Donor1_S1_BC0012_N01\" tail(rownames(CCA_PCs)) # RNA cells #> [1] \"Control_1h_Donor4_tgtagtggagttgcacgttgg\" #> [2] \"Control_1h_Donor4_aatggccgcacagccgcgctt\" #> [3] \"Control_1h_Donor4_cggccaggtcggttttggtta\" #> [4] \"Control_1h_Donor4_ggcaggctccttaactggcat\" #> [5] \"Control_1h_Donor4_gcagtgtactacgactggcat\" #> [6] \"Control_1h_Donor4_tcagcaatcgcgcattcctct\" isATAC <- grepl(\"BC\",rownames(CCA_PCs)) table(isATAC) # ATAC vs RNA #> isATAC #> FALSE  TRUE  #>  3508  5352 ATACcells <- rownames(CCA_PCs)[isATAC] RNAcells <- rownames(CCA_PCs)[!isATAC]  cat(\"ATAC cells in condition: \",length(ATACcells),\"\\n\") #> ATAC cells in condition:  5352 cat(\"RNA cells in condition: \",length(RNAcells),\"\\n\") #> RNA cells in condition:  3508 nPCs <- 20 # Num CCA PCs to use when running UMAP / pairing  # Run UMAP set.seed(123) umap.out <- uwot::umap(CCA_PCs[,1:nPCs],                        metric=\"cosine\",                        n_neighbors=30)  umap.d <- as.data.frame(umap.out) colnames(umap.d) <- c(\"UMAP1\",\"UMAP2\") rownames(umap.d) <- rownames(CCA_PCs)    umap.d$Assay <- ifelse(isATAC,\"ATAC\",\"RNA\")  BuenColors::shuf(umap.d) %>%    ggplot(aes(UMAP1,UMAP2,color=Assay)) +    geom_point(size=0.1) +    theme_classic() +    scale_color_manual(values = c(\"cadetblue\",\"darkorange\"))+   guides(colour = guide_legend(override.aes = list(size=3))) ATAC_PCs <- CCA_PCs[isATAC,] RNA_PCs <- CCA_PCs[!isATAC,]  pairing <- pairCells(ATAC = ATAC_PCs,                      RNA = RNA_PCs,                      keepUnique = TRUE) plotPairs(ATAC = pairing$ATAC,           RNA=pairing$RNA,           max.show = 100,           umap.df = umap.d) #> Assuming concordance in pairs .. #> Only highlighting 100 pairs at random.. #> Loading required package: ggrastr #> Warning: package 'ggrastr' was built under R version 4.0.4 ATAC.se.paired <- ATAC.se[,pairing$ATAC] RNAmat.paired <- RNAmat[,pairing$RNA]"},{"path":"https://buenrostrolab.github.io/FigR-docs/articles/FigR_stim.html","id":"peak-gene-association-testing","dir":"Articles","previous_headings":"Running FigR on independently assayed scATAC-seq and scRNA-seq data","what":"Peak-gene association testing","title":"Analyzing independently assayed scATAC-seq and scRNA-seq data using FigR","text":"","code":"# Don't run interactively cisCorr <- runGenePeakcorr(ATAC.se = ATAC.se.paired,                            RNAmat = RNAmat.paired,                            genome = \"hg19\", # One of hg19, mm10 or hg38                             nCores = 4,                            p.cut = NULL, # Set this to NULL and we can filter later                            n_bg = 100)"},{"path":"https://buenrostrolab.github.io/FigR-docs/articles/FigR_stim.html","id":"determining-dorcs","dir":"Articles","previous_headings":"Running FigR on independently assayed scATAC-seq and scRNA-seq data","what":"Determining DORCs","title":"Analyzing independently assayed scATAC-seq and scRNA-seq data using FigR","text":"can now filter correlations based background p-value, summarize genes relatively high number peak-gene associations (.e. Domains regulatory chromatin ‘DORCs’)  can also just get full ranked table genes number significantly associated peaks, instead getting gene names (can threshold ) Since unstimulated (control) PBMCs, expect genes lineage-determining markers.","code":"head(cisCorr) #>   Peak         PeakRanges      Gene        rObs       pvalZ #> 1    2 chr1:713966-714266 LINC01128 0.018159834 0.100025782 #> 2    5 chr1:756685-756985 LINC01128 0.004361716 0.318375663 #> 3    8 chr1:777265-777565 LINC01128 0.006061255 0.165574826 #> 4   19 chr1:839948-840248    SAMD11 0.003911159 0.289553871 #> 5   23 chr1:848168-848468    SAMD11 0.045598153 0.005385101 #> 6   26 chr1:859076-859376    SAMD11 0.031427158 0.107115444 cisCorr.filt <- cisCorr %>% filter(pvalZ <= 0.05)  library(ggplot2) dorcGenes <- dorcJPlot(dorcTab = cisCorr.filt,                          cutoff = 10, # No. sig peaks needed to be called a DORC                          labelTop = 20,                          returnGeneList = TRUE, # Set this to FALSE for just the plot                          force=5) # Unfiltered numDorcs <- cisCorr.filt %>% group_by(Gene) %>% tally() %>% arrange(desc(n)) numDorcs #> # A tibble: 9,272 x 2 #>    Gene         n #>    <chr>    <int> #>  1 IL7R        23 #>  2 TCF7        23 #>  3 CD83        22 #>  4 SEMA7A      20 #>  5 APOBEC3G    19 #>  6 CCR7        18 #>  7 CD8A        18 #>  8 PAX5        18 #>  9 SLC7A5      18 #> 10 ANPEP       17 #> # ... with 9,262 more rows"},{"path":"https://buenrostrolab.github.io/FigR-docs/articles/FigR_stim.html","id":"visualizing-dorcs","dir":"Articles","previous_headings":"Running FigR on independently assayed scATAC-seq and scRNA-seq data","what":"Visualizing DORCs","title":"Analyzing independently assayed scATAC-seq and scRNA-seq data using FigR","text":"get DORC accessibility scores, can sum chromatin accessibility peak counts peaks associated given gene. NOTE: crucial use exact SummarizedExperiment object one used runGenePeakcorr step plot scores, along paired RNA expression onto original scATAC-seq UMAP. ’s look 2D embedding looks like (also highlighted manuscript), just subset cells:  can smooth (sparse) DORC counts, visualize side--side expression, UMAP. particular case, use original Latent Semantic Indexing (LSI) cell embeddings pre-determined using cells (using 2D UMAP determined), subset cells used, derive cell k-nearest neighbors, use smooth DORC [aired RNA expression, UMAP:","code":"dorcMat <- getDORCScores(ATAC.se = ATAC.se.paired, # Has to be same SE as used in previous step                          dorcTab = cisCorr.filt,                          geneList = dorcGenes,                          nCores = 4) #> ........ #> Normalizing scATAC counts .. #> Centering counts for cells sequentially in groups of size  5000  .. #>  #> Computing centered counts for cells:  1  to  4912 .. #> Computing centered counts per cell using mean reads in features .. #>  #> Merging results.. #> Done! #> Computing DORC scores .. #> Running in parallel using  1 cores .. #>  #> Time Elapsed:  9.89641904830933 secs dim(dorcMat) #> [1]   99 4912 colData(ATAC.se.paired) %>%    as.data.frame() %>%    ggplot(aes(UMAP1,UMAP2)) +    geom_point(color=\"gray\",size=0.8)+ theme_classic() lsi <- readRDS(\"./control1h_PBMC_atac_lsi.rds\") dim(lsi)  stopifnot(all(colnames(dorcMat) %in% rownames(lsi)))  # Subset to paired ATAC lsi <- lsi[colnames(dorcMat),]  dim(lsi)  # Get cell KNNs cellkNN <- FNN::get.knn(lsi,k=30)$nn.index rownames(cellkNN) <- colnames(dorcMat)  # Smooth dorc scores using cell KNNs (k=30) library(doParallel) dorcMat.s <- smoothScoresNN(NNmat = cellkNN,mat = dorcMat,nCores = 4)  # Smooth RNA using cell KNNs # This takes longer since it's all genes colnames(RNAmat.paired) <- colnames(ATAC.se.paired) # Just so that the smoothing function doesn't throw an error (matching cell barcodes in the KNN and the matrix) RNAmat.s <- smoothScoresNN(NNmat = cellkNN,mat = RNAmat.paired,nCores = 4) # Visualize on pre-computed UMAP # This is the ATAC UMAP shown in the paper (based on ATAC LSI) umap.d <- as.data.frame(colData(ATAC.se.paired)[,c(\"UMAP1\",\"UMAP2\")])  # DORC scores for top DORC(s) myDORCs <- c(\"SEMA7A\",\"IL7R\",\"CD93\")  dorcGGlist <- lapply(myDORCs,function(x) {    plotMarker2D(umap.d,                dorcMat.s,                markers = x,                maxCutoff = \"q0.99\",                colorPalette = \"brewer_heat\"   ) + ggtitle(paste0(x,\" DORC\")) }) #> Plotting  SEMA7A  #> Plotting  IL7R  #> Plotting  CD93 # Paired RNA expression for top DORC(s) # Plot on the same reference ATAC UMAP rnaGGlist <- lapply(myDORCs,function(x) {    plotMarker2D(umap.d,                RNAmat.s,                markers = x,                maxCutoff = \"q0.99\",                colorPalette = \"brewer_purple\"   ) + ggtitle(paste0(x,\" RNA\")) }) #> Plotting  SEMA7A  #> Plotting  IL7R  #> Plotting  CD93 library(patchwork) #> Warning: package 'patchwork' was built under R version 4.0.4 (dorcGGlist[[1]] + dorcGGlist[[2]] + dorcGGlist[[3]]) /  (rnaGGlist[[1]] + rnaGGlist[[2]] + rnaGGlist[[3]])"},{"path":"https://buenrostrolab.github.io/FigR-docs/articles/FigR_stim.html","id":"tf-gene-associations","dir":"Articles","previous_headings":"Running FigR on independently assayed scATAC-seq and scRNA-seq data","what":"TF-gene associations","title":"Analyzing independently assayed scATAC-seq and scRNA-seq data using FigR","text":", can now determine TF-gene associations, begin inferring regulatory network based previous DORC definitions, together information drawn database TF binding sequence motifs","code":"figR.d <- runFigRGRN(ATAC.se = ATAC.se.paired, # Must be the same input as used in runGenePeakcorr()                      dorcTab = cisCorr.filt, # Filtered peak-gene associations                      genome = \"hg19\",                      dorcMat = dorcMat.s,                      dorcK = 5,                       rnaMat = RNAmat.s,                       nCores = 4)"},{"path":[]},{"path":"https://buenrostrolab.github.io/FigR-docs/articles/FigR_stim.html","id":"global-regulation-profile","dir":"Articles","previous_headings":"Running FigR on independently assayed scATAC-seq and scRNA-seq data > Visualizing FigR results","what":"Global regulation profile","title":"Analyzing independently assayed scATAC-seq and scRNA-seq data using FigR","text":"Scatter correlation (x) motif enrichment (y)  Looking top TFs associated DORCs","code":"figR.d %>%    ggplot(aes(Corr.log10P,Enrichment.log10P,color=Score)) +    ggrastr::geom_point_rast(size=0.01,shape=16) +    theme_classic() +    scale_color_gradientn(colours = jdb_palette(\"solar_extra\"),limits=c(-3,3),oob = scales::squish,breaks=scales::breaks_pretty(n=3))"},{"path":"https://buenrostrolab.github.io/FigR-docs/articles/FigR_stim.html","id":"ranking-tf-drivers","dir":"Articles","previous_headings":"Running FigR on independently assayed scATAC-seq and scRNA-seq data > Visualizing FigR results","what":"Ranking TF drivers","title":"Analyzing independently assayed scATAC-seq and scRNA-seq data using FigR","text":"can also set interactive parameter (rankDrivers function takes) TRUE, let hover points provide extra information terms number estimated activated vs repressed genes","code":"rankDrivers(figR.d,rankBy = \"meanScore\") #> Warning: ggrepel: 63 unlabeled data points (too many overlaps). Consider #> increasing max.overlaps rankDrivers(figR.d,score.cut = 1.5,rankBy = \"nTargets\",interactive = TRUE)"},{"path":"https://buenrostrolab.github.io/FigR-docs/articles/FigR_stim.html","id":"heatmap-view","dir":"Articles","previous_headings":"Running FigR on independently assayed scATAC-seq and scRNA-seq data > Visualizing FigR results","what":"Heatmap view","title":"Analyzing independently assayed scATAC-seq and scRNA-seq data using FigR","text":"","code":"library(ComplexHeatmap) plotfigRHeatmap(figR.d = figR.d,                 score.cut = 1.5,                 column_names_gp = gpar(fontsize=6), # from ComplexHeatmap                 show_row_dend = FALSE # from ComplexHeatmap                 )"},{"path":"https://buenrostrolab.github.io/FigR-docs/articles/FigR_stim.html","id":"network-view","dir":"Articles","previous_headings":"Running FigR on independently assayed scATAC-seq and scRNA-seq data > Visualizing FigR results","what":"Network view","title":"Analyzing independently assayed scATAC-seq and scRNA-seq data using FigR","text":"","code":"library(networkD3) #> Warning: package 'networkD3' was built under R version 4.0.5 plotfigRNetwork(figR.d,                       score.cut = 1.5,                       weight.edges = TRUE)"},{"path":"https://buenrostrolab.github.io/FigR-docs/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Vinay Kartha. Maintainer.","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Kartha, VK. et al. Functional Inference Gene Regulation using Single-Cell Multi-Omics. BioRxiv (2021)","code":"@Article{,   title = {Functional Inference of Gene Regulation using Single-Cell Multi-Omics},   author = {Vinay Kartha et al.},   journal = {BiorXiv preprint},   year = {2021},   url = {https://www.biorxiv.org/content/10.1101/2021.07.28.453784v1}, }"},{"path":"https://buenrostrolab.github.io/FigR-docs/index.html","id":"functional-inference-of-gene-regulation-figr","dir":"","previous_headings":"","what":"Functional Inference of Gene Regulation (FigR) using paired single cell ATAC-seq and RNA-seq data","title":"Functional Inference of Gene Regulation (FigR) using paired single cell ATAC-seq and RNA-seq data","text":"FigR computational framework supporting integration single cell chromatin accessibility gene expression data infer transcriptional regulators target genes  FigR uses independently concomitantly-profiled single-cell ATAC-seq (scATAC-seq) scRNA-seq, ) computationally-pair scATAC-seq scRNA-seq datasets (needed), ii) infers cis-regulatory interactions, iii) defines TF-gene gene regulatory network (GRN)","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Functional Inference of Gene Regulation (FigR) using paired single cell ATAC-seq and RNA-seq data","text":"devtools::install_github(\"buenrostrolab/FigR\")","code":""},{"path":[]},{"path":"https://buenrostrolab.github.io/FigR-docs/index.html","id":"dorc-calling","dir":"","previous_headings":"","what":"DORC calling","title":"Functional Inference of Gene Regulation (FigR) using paired single cell ATAC-seq and RNA-seq data","text":"SummarizedExperiment object scATAC-seq reads peaks counts (peaks x cells), well sparseMatrix object scRNA-seq gene counts (genes x cells) paired (either computationally true multi-modal), can determine cis-regulatory associations (gene-peak correlations) follows Cis-regulatory correlation analysis framework identify gene-peak (chromatin accessibility peak) significant associations deduce key genes domains regulatory activity (DORCs)","code":"# Run using multiple cores if parallel support cisCor <- runGenePeakcorr(ATAC.se = ATAC.SE,                            RNAmat = rnaMat,                            genome = \"hg19\", # Also supports mm10 and hg38                            nCores = 4,                             p.cut=NULL)                      # Filter peak-gene correlations by p-value                     cisCor.filt <- cisCor %>% filter(pvalZ <= 0.05)  # Determine DORC genes dorcGenes <- cisCor.filt %>% dorcJplot()  # Get DORC scores dorcMat <- getDORCscores(ATAC.SE,dorcTab=cisCor.filt,geneList=dorcGenes,nCores=4)  # Smooth DORC scores (using cell KNNs) dorcMat.smooth <- smoothScoresNN(NNmat=cellKNN.mat,mat=dorcMat,nCores=4)"},{"path":"https://buenrostrolab.github.io/FigR-docs/index.html","id":"figr","dir":"","previous_headings":"","what":"FigR","title":"Functional Inference of Gene Regulation (FigR) using paired single cell ATAC-seq and RNA-seq data","text":"DORC definitions, can use , along paired RNA data, run core FigR function. returns table regulations cores DORC gene TF reference database, can filter visualize (see section )","code":"# Run FigR fig.d <- runFigRGRN(ATAC.se=,ATAC.SE,                     rnaMat=rnaMat.smooth, # Smoothed RNA matrix using paired cell kNNs                     dorcMat=dorcMat.smooth,                     dorcTab=cisCor.filt,                     genome=\"hg19\",                     dorcGenes=dorcGenes,                     nCores=4)"},{"path":"https://buenrostrolab.github.io/FigR-docs/index.html","id":"visualizing-figr-results","dir":"","previous_headings":"","what":"Visualizing FigR results","title":"Functional Inference of Gene Regulation (FigR) using paired single cell ATAC-seq and RNA-seq data","text":"","code":"# Visualize all TF-DORC regulation scores (Scatter plot) require(ggplot2) require(BuenColors) # https://github.com/caleblareau/BuenColors  fig.d %>% ggplot(aes(Corr.log10P,Enrichment.log10P,color=Score)) +           geom_point_rast(size=0.01,shape=16) +            theme_classic() +           scale_color_gradientn(colours = jdb_palette(\"solar_extra\"),limits=c(-4,4),oob = scales::squish)"},{"path":"https://buenrostrolab.github.io/FigR-docs/index.html","id":"about","dir":"","previous_headings":"","what":"About","title":"Functional Inference of Gene Regulation (FigR) using paired single cell ATAC-seq and RNA-seq data","text":"actively developing package include detailed vignettes soon! Check walkthroughs applying FigR framework multi-modal independently derived scATAC-seq / scRNA-seq data clicking links :","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/index.html","id":"reference","dir":"","previous_headings":"","what":"Reference","title":"Functional Inference of Gene Regulation (FigR) using paired single cell ATAC-seq and RNA-seq data","text":"See recent preprint detailing use FigR framework gene regulatory network inference using scATAC scRNA-seq integration","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/cell_pairing.html","id":null,"dir":"Reference","previous_headings":"","what":"Pair cells — cell_pairing","title":"Pair cells — cell_pairing","text":"Perform geodesic pairing using ATAC/RNA co-embedding components","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/cell_pairing.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pair cells — cell_pairing","text":"","code":"cell_pairing(   ATACpcs,   RNApcs,   mode = \"geodesic\",   tol = 1e-04,   search_range = 0.2,   max_multimatch = 5,   umap_knn_k = 30,   min_subgraph_size = 50,   cca_umap_df = NULL,   seed = 123 )"},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/cell_pairing.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pair cells — cell_pairing","text":"ATACpcs combined co-embedding components matrix ATAC cells. Must valid ATAC cell barcode names rownames. RNApcs combined co-embedding components matrix RNA cells. Must valid RNA cell barcode names rownames (unique ATAC cell barcodes), number components (columns) `ATACpcs` matrix mode character specifying pairing mode. Must one 'geodesic' (default) 'greedy'. tol See fullmatch information parameter search_range determines size search knn window allowed pairing. search_range * total number cells = size knn. Default 0.2. Increasing can take time since evaluate possible pairs max_multimatch Maximum number cells larger dataset allowed matched cell smaller dataset (-sampling). Default 5. allow solvable optmatch solution given geodesic constraints umap_knn_k Number geodesic ATAC x RNA neighbors consider co-embedding graph min_subgraph_size Minimum number cells (ATAC/RNA ) needed pairing given subgraph. skip subgraphs fewer cells.Default 50 cells. Useful set smallest cell cluster size might data cca_umap_df optional umap ATAC+RNA cells visualize UMAP cells chunk paired, colored subgraph seed numeric specifying seed use subgraph UMAP -sampling case subgraphs imbalanced","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/cell_pairing.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pair cells — cell_pairing","text":"data.frame object containing ATAC RNA cell barcodes resulting pairing","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/cell_pairing.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Pair cells — cell_pairing","text":"Yan Hu, Vinay Kartha","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/centerCounts.html","id":null,"dir":"Reference","previous_headings":"","what":"Center single-cell ATAC-seq count data — centerCounts","title":"Center single-cell ATAC-seq count data — centerCounts","text":"Function center raw read counts scATAC-seq data based mean reads features/rows (e.g. peaks) per cell","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/centerCounts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Center single-cell ATAC-seq count data — centerCounts","text":"","code":"centerCounts(obj, doInChunks = TRUE, chunkSize = 1000)"},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/centerCounts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Center single-cell ATAC-seq count data — centerCounts","text":"obj Either RangedSummarizedExperiment-class dgeMatrix-class object single-cell ATAC data (peaks x cells) center raw data doInChunks boolean value whether score cells chunks (useful large scATAC datasets > 5,000 cells). TRUE, cells centered sequentially chunks size=1000 cells time avoid memory limitations, eventually merged (column-wise). Overriden set TRUE > 10,000 cells dataset chunkSize numeric specifying number cells perform centering , running chunks (save memory). Default 1000","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/centerCounts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Center single-cell ATAC-seq count data — centerCounts","text":"Either RangedSummarizedExperiment-class dgeMatrix-class object counts centered mean reads peaks per cell","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/centerCounts.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Center single-cell ATAC-seq count data — centerCounts","text":"Vinay Kartha","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/dorcJPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"DORC J scatter plot — dorcJPlot","title":"DORC J scatter plot — dorcJPlot","text":"Function visualize genes based number significant gene-peak correlations (per gene), used define DORCs","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/dorcJPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DORC J scatter plot — dorcJPlot","text":"","code":"dorcJPlot(   dorcTab,   cutoff = 7,   labelTop = 25,   returnGeneList = FALSE,   cleanLabels = TRUE,   labelSize = 4,   ... )"},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/dorcJPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"DORC J scatter plot — dorcJPlot","text":"dorcTab data.frame object containing significant peak-gene pairs using DORC scores computed. Must filtered set returned runGenePeakcorr. IMPORTANT: Make sure exact scATAC SE (peak set) used determining DORCs used get corresponding DORC peak counts cutoff numeric indicating cut-use number significant peaks per gene call DORC. Default 7 significant peaks per gene. labelTop numeric indicating number top genes add labels . Setting high number can lead plot rendering difficulties (since labels get crowded). returnGeneList boolean indicating whether also return DORCs passing provided filter. Default FALSE (just plot nothing else) cleanLabels boolean indicating whether try cleaner DORC gene labels. TRUE, uses geom_text_repel, FALSE, use regular geom_text labelSize numeric indicating set label size . Default 4. ... additional parameters passed either geom_text_repel (cleanLabels set TRUE) geom_text. example, set size control font size, segment.length segment.color control call-segment length color etc.","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/dorcJPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"DORC J scatter plot — dorcJPlot","text":"ggplot object DORC J plot. returnGeneList set TRUE, also returns vector DORC genes passing specified threshold","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/dorcJPlot.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"DORC J scatter plot — dorcJPlot","text":"Vinay Kartha","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/extractTFNames.html","id":null,"dir":"Reference","previous_headings":"","what":"Fetch TF names — extractTFNames","title":"Fetch TF names — extractTFNames","text":"function fetches TF names full motif IDs (see https://github.com/GreenleafLab/chromVARmotifs)","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/extractTFNames.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fetch TF names — extractTFNames","text":"","code":"extractTFNames(motifIDs)"},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/extractTFNames.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fetch TF names — extractTFNames","text":"motifIDs vector full motif IDs part original human mouse pwms matrix (see https://github.com/GreenleafLab/chromVARmotifs)","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/extractTFNames.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fetch TF names — extractTFNames","text":"vector TF names extracted full motif ID (older format '_'), returned otherwise","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/extractTFNames.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Fetch TF names — extractTFNames","text":"Vinay Kartha","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/getDORCScores.html","id":null,"dir":"Reference","previous_headings":"","what":"DORC scATAC-seq score summarization for single cells — getDORCScores","title":"DORC scATAC-seq score summarization for single cells — getDORCScores","text":"Function compute single cell DORC scores gene identified DORC (see runGenePeakcorr determining DORCs peak-gene correlations)","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/getDORCScores.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DORC scATAC-seq score summarization for single cells — getDORCScores","text":"","code":"getDORCScores(   ATAC.se,   dorcTab,   normalizeATACmat = TRUE,   geneList = NULL,   nCores = 4 )"},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/getDORCScores.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"DORC scATAC-seq score summarization for single cells — getDORCScores","text":"ATAC.se SummarizedExperiment object scATAC-seq reads peak counts. dorcTab data.frame object containing significant peak-gene pairs using DORC scores computed. Must filtered set returned runGenePeakcorr. IMPORTANT: Make sure exact scATAC SE (peak set) used determining DORCs used get corresponding DORC peak counts normalizeATACmat boolean indicating whether normalize counts present ATAC.se object prior summing peak counts per gene. Default TRUE (.e. assumes peak counts raw). geneList character vector specifying subset genes compute scores . Useful already set list DORCs want compute scores genes/peaks. nCores numeric indicating number cores use parallelizing tasks","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/getDORCScores.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"DORC scATAC-seq score summarization for single cells — getDORCScores","text":"Matrix object scores pertaining sum normalized scATAC peak counts per gene, determined significant gene-peak pairs calling DORCs","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/getDORCScores.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"DORC scATAC-seq score summarization for single cells — getDORCScores","text":"Vinay Kartha","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/motifPeakZtest.html","id":null,"dir":"Reference","previous_headings":"","what":"Peak-based TF motif enrichment Z-test — motifPeakZtest","title":"Peak-based TF motif enrichment Z-test — motifPeakZtest","text":"Wrapper function assess specific set peaks enrichment respect TF binding motifs using Z test adjusting GC bias Tn5 accessibility","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/motifPeakZtest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Peak-based TF motif enrichment Z-test — motifPeakZtest","text":"","code":"motifPeakZtest(peakSet, bgPeaks, tfMat)"},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/motifPeakZtest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Peak-based TF motif enrichment Z-test — motifPeakZtest","text":"peakSet vector peak indices wish test motif enrichment bgPeaks background peaks matrix returned getBackgroundPeaks function chromVAR tfMat binary match sparseMatrix object (reference) peaks TF motifs returned matchMotifs function","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/motifPeakZtest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Peak-based TF motif enrichment Z-test — motifPeakZtest","text":"data frame motif enrichment results rank sorted significance frequency motifs peakset, respectively","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/motifPeakZtest.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Peak-based TF motif enrichment Z-test — motifPeakZtest","text":"Vinay Kartha, Samuel Rose, Jason D. Buenrostro","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/pairCells.html","id":null,"dir":"Reference","previous_headings":"","what":"Pair cells — pairCells","title":"Pair cells — pairCells","text":"Wrapper function running ATAC/RNA pairing cell chunks using co-embedding components","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/pairCells.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pair cells — pairCells","text":"","code":"pairCells(ATAC, RNA, keepUnique = FALSE, ...)"},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/pairCells.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pair cells — pairCells","text":"ATAC combined co-embedding components matrix ATAC cells (e.g. CCA). Must valid ATAC cell barcode names rownames. RNA `ATAC`, RNA cells. Must valid RNA cell barcode names rownames (unique ATAC cell barcodes), number components (columns) `ATAC` matrix keepUnique boolean indicating whether remove resulting many--many ATAC-RNA paired cells returned geodesic pairing method (depending `max_multimatch` parameter set FigR[cell_pairing], defaults 5). Default FALSE, meaning returned pairing, can single cell larger dataset paired upto `max_multimatch` cells smaller dataset. See FigR[cell_pairing] details. set TRUE, filter pairs return cell larger dataset best match smaller dataset (among multiple options, ) based min euclidean distances pair options (supplied reduced dimension space). Useful RNA ATAC cell cluster label transfer (since ATAC cell can acquire single cluster identity based best RNA cell match), required downstream analyses (peak-gene correlations TF-DORC associations) ... additional parameters passed cell_pairing. Useful parameters enabling search solution include `search_range` `min_subgraph_size`, dictates cells potentially excluded paired","code":""},{"path":[]},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/pairCells.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Pair cells — pairCells","text":"Vinay Kartha Yan Hu","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotDrivers.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot FigR scatter profile — plotDrivers","title":"Plot FigR scatter profile — plotDrivers","text":"Scatter plot visualization filtered TF-DORC associations based enrichment motif among queried DORC's peaks correlation TF RNA DORC accessibility score","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotDrivers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot FigR scatter profile — plotDrivers","text":"","code":"plotDrivers(figR.d, marker, score.cut = 1, label = TRUE)"},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotDrivers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot FigR scatter profile — plotDrivers","text":"figR.d data.frame results returned runFigRGRN) marker character specifying valid DORC gene restrict TF drivers score.cut numeric specifying absolute regulation score threshold TF-DORC connections . Default 1 label boolean indicating whether add text labels TF drivers passing score filter","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotDrivers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot FigR scatter profile — plotDrivers","text":"ggplot2 object scatter plot predicted TF drivers specified DORC","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotDrivers.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plot FigR scatter profile — plotDrivers","text":"Vinay Kartha","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotfigRHeatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot FigR heatmap — plotfigRHeatmap","title":"Plot FigR heatmap — plotfigRHeatmap","text":"Heatmap visualization TF-DORC associations based regulation scores inferred FigR","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotfigRHeatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot FigR heatmap — plotfigRHeatmap","text":"","code":"plotfigRHeatmap(figR.d, score.cut = 1, DORCs = NULL, TFs = NULL, ...)"},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotfigRHeatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot FigR heatmap — plotfigRHeatmap","text":"figR.d data.frame results returned runFigRGRN). score.cut numeric specifying absolute regulation score threshold TF-DORC connections . Default 1 DORCs character specifying valid DORC gene symbols subset heatmap . Default NULL (subsetting) TFs character specifying valid TF gene symbols subset heatmap . Default NULL (subsetting) ... additional parameters passed Heatmap)","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotfigRHeatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot FigR heatmap — plotfigRHeatmap","text":"TF-DORC filtered Heatmap generatd using Heatmap)","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotfigRHeatmap.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plot FigR heatmap — plotfigRHeatmap","text":"Vinay Kartha","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotfigRNetwork.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot FigR Network — plotfigRNetwork","title":"Plot FigR Network — plotfigRNetwork","text":"Network visualization TF-DORC associations based regulation scores inferred FigR","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotfigRNetwork.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot FigR Network — plotfigRNetwork","text":"","code":"plotfigRNetwork(   figR.d,   score.cut = 1,   DORCs = NULL,   TFs = NULL,   weight.edges = FALSE )"},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotfigRNetwork.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot FigR Network — plotfigRNetwork","text":"figR.d data.frame results returned runFigRGRN) score.cut numeric specifying absolute regulation score threshold TF-DORC connections . Default 1 DORCs character specifying valid DORC gene symbols subset heatmap . Default NULL (subsetting) TFs character specifying valid TF gene symbols subset heatmap . Default NULL (subsetting) weight.edge boolean specifying whether weight edges FigR regulation score. Default FALSE","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotfigRNetwork.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot FigR Network — plotfigRNetwork","text":"network plot resulting filtered TF-DORC associations","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotfigRNetwork.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plot FigR Network — plotfigRNetwork","text":"Vinay Kartha","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotMarker2D.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot marker scores on single cell scatter plots — plotMarker2D","title":"Plot marker scores on single cell scatter plots — plotMarker2D","text":"Function plot variable interest (e.g. scATAC-seq gene score, motif score, scRNA-seq expression etc.) onto existing tSNE/UMAP coordinates single cell clusters","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotMarker2D.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot marker scores on single cell scatter plots — plotMarker2D","text":"","code":"plotMarker2D(   df,   markers,   markerMat,   pointSize = 0.5,   plotClean = TRUE,   rasteRize = TRUE,   splitBy = NULL,   minCutoff = NULL,   maxCutoff = NULL,   colorPalette = \"solar_extra\",   legend.position = \"bottom\",   showDataRange = TRUE,   combine = TRUE,   ... )"},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotMarker2D.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot marker scores on single cell scatter plots — plotMarker2D","text":"df data.frame object 2-D coordinates, row cell first two columns corresponds first (x-axis) second (y-axis) dimensions use plot (e.g. UMAP coordinates). Can additional cell metadata columns used splitting (see splitBy parameter) markers character vector markers visualize (can list multiple). Must one rownames markerMat markerMat matrix scores containing markers visualize. Can sparse matrix. Must rownames pointSize integer specifying point size use ggplot (passed geom_point() layer ggplot). Default 0.5 plotClean boolean indicating whether return 'clean' plot without axes rasteRize boolean indicating whether use raster point rendering (avoid giant file sizes many point layers PDFs). Requires ggrastr package set TRUE (Default) splitBy character indicating single variable split cells using facets visualizing. Must valid column name df minCutoff cut use capping  minimum values prior visualization. Can either raw numeric value, percentile value cut-(0-1) number standard deviations mean, used set minimum value dataset prior plotting. percentiles, must character 'q' percentile cut-value (e.g. 'q0.1' 10%ile minimum). standard deviation-based capping, must character 'sd' cut-value (e.g. 'sd2' using 2 standard deviations mean minimum value displayed) maxCutoff cut use capping  maximum values prior visualization. Can either raw numeric value, percentile value cut-(0-1) number standard deviations mean, used set minimum value dataset prior plotting. percentiles, must character 'q' percentile cut-value (e.g. 'q0.9' 90%ile maximum). standard deviation-based capping, must character 'sd' cut-value (e.g. 'sd2' using 2 standard deviations mean maximum value displayed) colorPalette color palette name specification use coloring points. Default \"solar_extra\". See BuenColors package developed Caleb Lareau palette options legend.position character specifying place legend. Valid options \"top\", \"bottom\", \"left\", \"right\", \"none\" (remove legend completely). Default bottom showDataRange boolean indicating whether show data numeric range legends (applies legends displayed). Default TRUE. set FALSE, just shows min max combine boolean indicating whether merge plots display grid.Default TRUE ... extra parameters passed cowplot's plot_grid function control organization plot grids. Useful parameters include nrow ncol control number rows columns layout, respectively","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotMarker2D.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot marker scores on single cell scatter plots — plotMarker2D","text":"single marker queried, combine set TRUE multiple markers, ggplot object printed graphics window unless assigned variable. combine set FALSE, list object individual plots per marker returned","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotMarker2D.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plot marker scores on single cell scatter plots — plotMarker2D","text":"Vinay Kartha","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotPairs.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot ATAC-RNA scOptMatch pairs — plotPairs","title":"Plot ATAC-RNA scOptMatch pairs — plotPairs","text":"Function plot ATAC-RNA pairs joint embedding space (.e.g  2D UMAP ATAC RNA cells)","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotPairs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot ATAC-RNA scOptMatch pairs — plotPairs","text":"","code":"plotPairs(ATAC, RNA, umap.df, max.show = 300, seed = 123, pairPointSize = 1)"},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotPairs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot ATAC-RNA scOptMatch pairs — plotPairs","text":"ATAC character vector ATAC barcodes returned resulting pairing data frame returned cell_pairing function RNA character vector RNA barcodes returned resulting pairing data frame returned cell_pairing function umap.df data.frame ATAC/RNA co-embedding UMAP 1/2 coordinates first second columns, respectively. Must valid ATAC RNA barcodes row names, used subset pairs max.show numeric specifying maximum number pairs limit plotting . Default 300 (choose fewer better visibility UMAP crowded) seed numeric specifying random seed set sampling pairs (reproducibility). Default 123 pairPointSize scatter plot point size. Default 1","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotPairs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot ATAC-RNA scOptMatch pairs — plotPairs","text":"ggplot scatter plot user-provided coordinates, highlighting ATAC-RNA pairs","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/plotPairs.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plot ATAC-RNA scOptMatch pairs — plotPairs","text":"Vinay Kartha","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/rankDrivers.html","id":null,"dir":"Reference","previous_headings":"","what":"Rank TF drivers — rankDrivers","title":"Rank TF drivers — rankDrivers","text":"Ranked plot TF activators repressors based inferred regulation score","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/rankDrivers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rank TF drivers — rankDrivers","text":"","code":"rankDrivers(   figR.d,   rankBy = c(\"meanScore\", \"nTargets\"),   myLabels = NULL,   score.cut = NULL,   interactive = FALSE )"},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/rankDrivers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rank TF drivers — rankDrivers","text":"figR.d data.frame results returned runFigRGRN) rankBy character specifying one \"meanScore\" \"nTargets\" either rank TFs mean regulation score across genes, total number inferred activated repressed targets passing specified (absolute) regulation score, respectively myLabels character vector specifying subset TFs highlight plot, rankBy set \"meanScore\". Useful want see TFs interest lie. NULL (Default), label top bottom 95 percentile TFs score.cut numeric specifying absolute regulation score threshold TF-DORC connections , rankBy set \"nTargets\". Default 1 \"nTargets\" custom cut-specified interactive boolean indicating whether allow interactive hover-utility label information (useful visualizing many TFs labels hard distinguish). Default FALSE","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/rankDrivers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rank TF drivers — rankDrivers","text":"ggplot2 object resulting plot","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/rankDrivers.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Rank TF drivers — rankDrivers","text":"Vinay Kartha","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/runFigRGRN.html","id":null,"dir":"Reference","previous_headings":"","what":"Infer FigR TF-DORC associations — runFigRGRN","title":"Infer FigR TF-DORC associations — runFigRGRN","text":"Function run TF motif--gene associations using reference DORC peak-gene mappings TF RNA expression levels","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/runFigRGRN.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Infer FigR TF-DORC associations — runFigRGRN","text":"","code":"runFigRGRN(   ATAC.se,   dorcK = 30,   dorcTab,   n_bg = 50,   genome,   dorcMat,   rnaMat,   dorcGenes = NULL,   nCores = 1 )"},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/runFigRGRN.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Infer FigR TF-DORC associations — runFigRGRN","text":"ATAC.se SummarizedExperiment object peak x cell scATAC-seq data, used compute DORCs using runGenePeakcorr dorcK numeric specifying number dorc nearest-neighbors pool peaks motif enrichment per DORC. Default 30, .e. set ~3 percent total DORCs determined dorcTab data.frame object containing significant peak-gene pairs using DORC scores computed. Must filtered set returned runGenePeakcorr. IMPORTANT: Make sure exact scATAC SE peak set used determining DORCs used get corresponding DORC peak counts n_bg number background peaks use genome character specifying valid genome assembly use peak GC content estimation background peak determination. Must one \"hg19\",\"hg38\", \"mm10\", requires corresponding genomes package e.g. BSgenome.Hsapiens.UCSC.hg19 hg19 dorcMat Matrix object smoothed single-cell DORC accessibility scores rnaMat Matrix object smoothed single-cell RNA expression values dorcGenes character vector specifying subset DORCs test, running everything nCores numeric specifying number cores run DORCs parallel. Default 1, .e. use parallel backend","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/runFigRGRN.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Infer FigR TF-DORC associations — runFigRGRN","text":"data.frame TF-DORC motif enrichment correlation associations, corresponding FigR regulation score association","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/runFigRGRN.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Infer FigR TF-DORC associations — runFigRGRN","text":"Vinay Kartha","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/runGenePeakcorr.html","id":null,"dir":"Reference","previous_headings":"","what":"Gene-Peak correlations used for calling domains of regulatory chromatin (DORCs) — runGenePeakcorr","title":"Gene-Peak correlations used for calling domains of regulatory chromatin (DORCs) — runGenePeakcorr","text":"Function compute correlation RNA expression peak accessibility peaks falling within window around gene, across single cells, using background peak correlations significance testing","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/runGenePeakcorr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gene-Peak correlations used for calling domains of regulatory chromatin (DORCs) — runGenePeakcorr","text":"","code":"runGenePeakcorr(   ATAC.se,   RNAmat,   genome,   geneList = NULL,   windowPadSize = 50000,   normalizeATACmat = TRUE,   nCores = 4,   keepPosCorOnly = TRUE,   keepMultiMappingPeaks = FALSE,   n_bg = 100,   p.cut = NULL )"},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/runGenePeakcorr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gene-Peak correlations used for calling domains of regulatory chromatin (DORCs) — runGenePeakcorr","text":"ATAC.se SummarizedExperiment object scATAC-seq reads peak counts. RNAmat Matrix object normalized scRNA-seq counts. example, normalized count data housed within `@assays$RNA@data` field processed using Seurat. Must number cells (.e. matched) scATAC-seq data genome character specifying reference genome build use. Must one \"hg19\", \"hg38\" \"mm10\", default normalizeATACmat boolean indicating whether normalize counts present ATAC.se object prior computing correlations. Default TRUE (.e. assumes peak counts ATAC.se raw) nCores numeric indicating number cores use parallelizing tasks keepPosCorOnly boolean indicating whether filter positively correlated gene-peak associations (hence assumes performing right-tailed Z-test permuted correlations). Default TRUE (keep positively correlated associations) keepMultiMappingPeaks boolean indicating whether keep peaks mapping 1 gene. Default FALSE (.e. force 1-1 mapping peak-gene, keeping peak higher correlation mapping one gene) n_bg numeric indicating number background correlations compute per gene-peak pair. Default 100 (increasing can significantly increase run time) p.cut numeric indicating p-value cut-apply gene-peak correlations. Default NULL (.e. apply filtering results). Good option set 0.05 TSSwindow numeric specifying window size (base pairs) pad around either side TSS, fetch overlapping peaks. Default 50 kb (100 kb window drawn arund TSS)","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/runGenePeakcorr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gene-Peak correlations used for calling domains of regulatory chromatin (DORCs) — runGenePeakcorr","text":"data.frame correlations gene-peak overlap pair, observed correlation level significance p-value based background correlations per pair","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/runGenePeakcorr.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Gene-Peak correlations used for calling domains of regulatory chromatin (DORCs) — runGenePeakcorr","text":"Vinay Kartha","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/smoothScoresNN.html","id":null,"dir":"Reference","previous_headings":"","what":"Smooth single cell matrix using cell kNNs — smoothScoresNN","title":"Smooth single cell matrix using cell kNNs — smoothScoresNN","text":"Method smooth sparse scores (e.g. RNA expression, ATAC gene scores, DORC scores) per cell per feature using cell K nearest neighbors (NNs). Useful visualizing scores single cells tSNE UMAP plots.","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/smoothScoresNN.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Smooth single cell matrix using cell kNNs — smoothScoresNN","text":"","code":"smoothScoresNN(NNmat, mat, geneList = NULL, barcodesList = NULL, nCores = 1)"},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/smoothScoresNN.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Smooth single cell matrix using cell kNNs — smoothScoresNN","text":"NNmat matrix K Nearest neighbor indices cell (row), column one K nearest neighbors per cell. See knn.index function obtaining K nearest neighbor maps. Rownames must valid cell IDs. mat matrix single cell scores. Rownames must valid gene symbols, column names must valid cell IDs matching rownames cell NN matrix. geneList vector valid gene names compute smoothed TSS accessibility scores . geneList NULL, genes (rows) TSS matrix used barcodesList vector valid barcode IDs subset data using compute smoothed TSS accessibility scores . barcodesList NULL, cell barcodes (columns) TSS matrix used nCores integer specifying number cores use, running parallel. Default 1 (.e. parallelization)","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/smoothScoresNN.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Smooth single cell matrix using cell kNNs — smoothScoresNN","text":"matrix scores gene TSS cell, smoothed K nearest neighbors","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/smoothScoresNN.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Smooth single cell matrix using cell kNNs — smoothScoresNN","text":"Vinay Kartha","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/splitAndFetch.html","id":null,"dir":"Reference","previous_headings":"","what":"Split and fetch string subparts — splitAndFetch","title":"Split and fetch string subparts — splitAndFetch","text":"Function split fetch string components based specific delimiter","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/splitAndFetch.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Split and fetch string subparts — splitAndFetch","text":"","code":"splitAndFetch(vec, delim, part)"},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/splitAndFetch.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Split and fetch string subparts — splitAndFetch","text":"vec character vector apply splitting delim character specifying delimitor separate string part integer specifying part fetch splitting","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/splitAndFetch.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Split and fetch string subparts — splitAndFetch","text":"substring based splitting criteria","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/splitAndFetch.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Split and fetch string subparts — splitAndFetch","text":"Vinay Kartha","code":""},{"path":"https://buenrostrolab.github.io/FigR-docs/reference/splitAndFetch.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Split and fetch string subparts — splitAndFetch","text":"","code":"my_string <- c(\"This_is_random_string.111\",\"Yes_it_is.222\") # Get first part splitting on _ splitAndFetch(vec=my_string,delim=\"_\",part=1) #> [1] \"This\" \"Yes\"  # Get first two parts splitting on _ splitAndFetch(vec=my_string,delim=\"_\",part=1:2) #> [1] \"This_is\" \"Yes_it\"  # Get second part splitting on . splitAndFetch(vec=my_string,delim=\".\",part=2) #> [1] \"111\" \"222\""}]
